import{o as a,c as i,w as e,a as t,b as d,t as s,d as o,r as l,F as n,e as f,f as c,i as u,g as m,p}from"./index.0acfa85f.js";import{_ as r}from"./my-video-card.48e6a55b.js";import{r as v}from"./uni-app.es.8c874889.js";import{_ as g}from"./plugin-vue_export-helper.21dcd24c.js";var y=g({data(){return{apis:{getVideoInfo:()=>{let a={url:`https://www.bilibili.com/video/${this.bvid}/`};return this.PB.apiRoute("/api/bili/base/getInitialState",a,"POST")}},aid:null,bvid:null,videoInfo:null,videoPageList:[]}},onLoad(a){this.aid=a.aid,this.bvid=a.bvid,this.init()},computed:{loadImg(){return a=>this.PB.loadImg(a)},shortNumForBoFang:()=>a=>a<1e4?a:(a/1e4).toFixed(1)+"万"},methods:{init(){this.PB.ajax(this.apis.getVideoInfo(),{cacheKey:this.aid+"_getVideoInfo",cacheTime:10}).then((a=>{this.videoInfo=a.data,this.getVideoPages(),console.log("videoInfo:",this.videoInfo),console.log("videoPageList:",this.videoPageList),this.$nextTick((()=>{document.querySelectorAll(".my-cid-item")[0].focus()}),1)}))},getVideoPages(){if(this.videoInfo.videoData.season_id){let a=this.videoInfo.videoData.ugc_season.sections.flatMap((a=>a.episodes.map((a=>({aid:a.aid,bvid:a.bvid,cid:a.page.cid,title:a.page.part||a.title})))));a=a.sort(((a,i)=>i.cid-a.cid)),this.videoPageList=a.slice(0,50)}else this.videoPageList=this.videoInfo.videoData.pages.map((a=>({aid:this.aid,bvid:this.bvid,cid:a.cid,title:a.part})))},openUp(a){this.PB.navigateTo(`/pages/main/up/index?mid=${a}`)},openTag(a){},openDetail(a){this.PB.navigateTo(`/pages/main/video/detail?aid=${a.aid}&bvid=${a.bvid}`)},play(a){if(this.PB.isAndroid()){let i={aid:a.aid,cid:a.cid,bvid:a.bvid,title:this.videoInfo.videoData.title};AndroidMain.openVideo(JSON.stringify(i))}else this.PB.navigateTo(`/pages/main/video/play?aid=${a.aid}&cid=${a.cid}&bvid=${a.bvid}`)}}},[["render",function(g,y,_,b,h,I){const P=c,k=u,x=m,D=v(p("my-video-card"),r);return h.videoInfo?(a(),i(k,{key:0},{default:e((()=>[t(k,{class:"my-wrap"},{default:e((()=>[t(k,{class:"my-aid-wrap"},{default:e((()=>[t(k,{class:"my-aid-photo-banner"},{default:e((()=>[t(P,{class:"my-aid-photo-img",mode:"aspectFill",src:I.loadImg(h.videoInfo.videoData.pic)},null,8,["src"])])),_:1}),t(k,{class:"my-aid-info-banner"},{default:e((()=>[t(k,{class:"my-aid-info-title-banner"},{default:e((()=>[d(s(h.videoInfo.videoData.title),1)])),_:1}),t(k,{class:"my-aid-info-upinfo-banner"},{default:e((()=>[t(k,{class:"my-aid-info-upinfo-col"},{default:e((()=>[t(x,{class:"my-tip"},{default:e((()=>[d("UP主：")])),_:1}),t(x,{class:"my-aid-info-upinfo-name",onClick:y[0]||(y[0]=a=>I.openUp(h.videoInfo.upData.mid))},{default:e((()=>[d(s(h.videoInfo.upData.name),1)])),_:1})])),_:1}),t(k,{class:"my-aid-info-upinfo-col"},{default:e((()=>[t(x,{class:"my-tip"},{default:e((()=>[d("投稿时间：")])),_:1}),t(x,{class:"my-aid-info-upinfo-name"},{default:e((()=>[d(s(new Date(1e3*h.videoInfo.videoData.pubdate).toJSON()),1)])),_:1})])),_:1})])),_:1}),t(k,{class:"my-aid-info-uv-banner"},{default:e((()=>[t(k,{class:"my-aid-info-uv-col"},{default:e((()=>[t(x,{class:"my-tip"},{default:e((()=>[d("播放：")])),_:1}),t(x,{class:"my-aid-info-uv-bofang"},{default:e((()=>[d(s(I.shortNumForBoFang(h.videoInfo.videoData.stat.view)),1)])),_:1})])),_:1}),t(k,{class:"my-aid-info-uv-col"},{default:e((()=>[t(x,{class:"my-tip"},{default:e((()=>[d("弹幕：")])),_:1}),t(x,{class:"my-aid-info-uv-danmu"},{default:e((()=>[d(s(h.videoInfo.videoData.stat.danmaku),1)])),_:1})])),_:1})])),_:1}),t(k,{class:"my-aid-info-tags-banner"},{default:e((()=>[t(k,null,{default:e((()=>[t(x,{class:"my-tip"},{default:e((()=>[d("标签：")])),_:1})])),_:1}),t(k,{class:"my-aid-info-tags-content"},{default:e((()=>[(a(!0),o(n,null,l(h.videoInfo.tags,(t=>(a(),i(k,{key:t.tag_id,tabindex:"0",onClick:a=>I.openTag(t),class:"my-aid-info-tags-item"},{default:e((()=>[d(s(t.tag_name),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1}),t(k,{class:"my-cid-wrap g-tabindex-noborder"},{default:e((()=>[t(k,null,{default:e((()=>[t(x,null,{default:e((()=>[d("分集")])),_:1})])),_:1}),t(k,{class:"my-cid-banner g-tabindex-noborder"},{default:e((()=>[(a(!0),o(n,null,l(h.videoPageList,((o,l)=>(a(),i(k,{class:"my-cid-item",tabindex:l+1,onClick:a=>I.play(o)},{default:e((()=>[t(x,{class:"my-cid-title"},{default:e((()=>[d(s(o.title),1)])),_:2},1024)])),_:2},1032,["tabindex","onClick"])))),256))])),_:1})])),_:1}),t(k,{class:"my-relevant-wrap"},{default:e((()=>[t(k,{class:"my-relevant-tip"},{default:e((()=>[t(x,null,{default:e((()=>[d("相关的")])),_:1})])),_:1}),t(k,{class:"my-relevant-banner g-tabindex-noborder","aria-hidden":"true",tabindex:"-1"},{default:e((()=>[(a(!0),o(n,null,l(h.videoInfo.related,(d=>(a(),i(k,{key:d.aid,onClick:a=>I.openDetail(d),class:"my-relevant-item"},{default:e((()=>[t(D,{"img-src":d.pic,title:d.title,"up-name":d.owner.name,"stat-play":d.stat.view,"stat-danmaku":d.stat.danmaku},null,8,["img-src","title","up-name","stat-play","stat-danmaku"])])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1})):f("",!0)}],["__scopeId","data-v-6597a035"]]);export{y as default};
